webpackJsonp([1],{1340:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),u=n(i),c=a(23),d=(n(c),a(100)),f=a(1399),m=n(f),h=function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={key:1},a}return s(t,e),o(t,[{key:"handleSelect",value:function(e){this.setState({key:e})}},{key:"componentDidMount",value:function(){document.title="系统历史警告"}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"home-main settings alarm"},u.default.createElement("header",null,u.default.createElement("div",{className:"settings-title"},"系统历史警告")),u.default.createElement(d.Tabs,{activeKey:this.state.key,id:"tabs",onSelect:function(t){return e.handleSelect(t)}},u.default.createElement(d.Tab,{eventKey:1,title:"警告列表"},1==this.state.key&&u.default.createElement(m.default,null))))}}]),t}(u.default.Component);t.default=h},1346:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),u=n(i),c=a(23),d=(n(c),a(1398)),f=n(d),m=a(1396),h=n(m),p=a(1397),g=n(p),y=a(100),b=function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={key:1},a}return s(t,e),o(t,[{key:"handleSelect",value:function(e){this.setState({key:e})}},{key:"componentDidMount",value:function(){document.title="系统设置"}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"home-main settings"},u.default.createElement("header",null,u.default.createElement("div",{className:"settings-title"},"系统设置")),u.default.createElement(y.Tabs,{activeKey:this.state.key,id:"tabs",onSelect:function(t){return e.handleSelect(t)}},u.default.createElement(y.Tab,{eventKey:1,title:"通用设置"},1==this.state.key&&u.default.createElement(g.default,null)),u.default.createElement(y.Tab,{eventKey:2,title:"警告通讯方式"},2==this.state.key&&u.default.createElement(f.default,null)),u.default.createElement(y.Tab,{eventKey:3,title:"登录附加凭证"},3==this.state.key&&u.default.createElement(h.default,null))))}}]),t}(u.default.Component);t.default=b},1353:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),u=n(i),c=a(23),d=n(c),f=function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={itemsToSelect:a.props.itemsToSelect,activeItem:a.props.itemDefault||a.props.itemsToSelect[0],showListBlock:!1},a}return s(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this;(0,d.default)(document).bind("click",function(t){if(e.state.showListBlock){for(var a=t||window.event,n=a.target||a.srcElement;n;){if(n.id&&n.id==e.props.listID)return;n=n.parentNode}e.setState({showListBlock:!1})}})}},{key:"componentWillReceiveProps",value:function(e){JSON.stringify(this.props.itemsToSelect)!=JSON.stringify(e.itemsToSelect)&&this.setState({itemsToSelect:e.itemsToSelect}),JSON.stringify(this.props.itemDefault)!=JSON.stringify(e.itemDefault)&&(this.setState({activeItem:e.itemDefault||e.itemsToSelect[0]}),this.props.onSelect(e.itemDefault.value))}},{key:"changeListState",value:function(){(0,d.default)(".my-dropdown-list .item-selected").blur(),(0,d.default)(".select-img i").toggleClass("fa-angle-down").toggleClass("fa-angle-up"),this.setState({showListBlock:!this.state.showListBlock})}},{key:"selectItem",value:function(e){this.setState({activeItem:e}),this.changeListState(),this.props.onSelect(e.value)}},{key:"render",value:function(){var e=this,t=this.state.itemsToSelect&&this.state.itemsToSelect.map(function(t,a){return u.default.createElement("li",{key:"select-item-"+a,className:JSON.stringify(t)==JSON.stringify(e.state.activeItem)?"active":"",onClick:e.selectItem.bind(e,t)},u.default.createElement("span",null,t.name))});return u.default.createElement("div",{className:"my-dropdown-list",id:this.props.listID},u.default.createElement("div",null,u.default.createElement("div",{className:"select-img",onClick:this.changeListState.bind(this)},u.default.createElement("i",{className:"fas fa-angle-down"})),u.default.createElement("input",{className:"item-selected",type:"text",readOnly:!0,value:this.state.activeItem&&this.state.activeItem.name,onClick:this.changeListState.bind(this)})),u.default.createElement("div",{className:this.state.showListBlock&&t.length>0?"list-block":"hide list-block"},u.default.createElement("ul",null,t)))}}]),t}(u.default.Component);t.default=f},1396:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=a(1),c=n(u),d=a(23),f=n(d),m=a(100),h=a(132),p=n(h),g=a(131),y=function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={showSetting:!1,showDisableSetting:!1,showDisableFaceID:!1,showFaceID:!1,error:null,usererror:null,pwderror:null,phonecodeError:null,phoneError:null,phoneCodeText:"获取验证码",flag:null,trackingText:"请您直视摄像头，正在识别中….",UUID:(0,g.getUUID)()},a}return s(t,e),i(t,[{key:"onChange",value:function(){this.setState({error:null,usererror:null,pwderror:null,phonecodeError:null,phoneError:null})}},{key:"isPass",value:function(e){return/^[0-9A-Za-z_]{6,18}$/.test(e)}},{key:"onBlurPhone",value:function(e){""!=e.target.value&&(!this.isPass(e.target.value)||e.target.value.length>18?this.setState({phoneError:"长度6~18的字符、数字和下划线"}):this.setState({phoneError:""}))}},{key:"onBlurUsr",value:function(e){""!=e.target.value&&(!this.isPass(e.target.value)||e.target.value.length>18?this.setState({usererror:"长度6~18的字符、数字和下划线"}):this.setState({usererror:""}))}},{key:"onBlurPWD",value:function(e){""!=e.target.value&&(!this.isPass(e.target.value)||e.target.value.length>18?this.setState({pwderror:"长度6~18的字符、数字和下划线"}):this.setState({pwderror:""}))}},{key:"showSetting",value:function(){this.setState({showSetting:!0}),this.onChange()}},{key:"hideSetting",value:function(){this.setState({showSetting:!1})}},{key:"showDisableSetting",value:function(){this.setState({showDisableSetting:!0}),this.onChange()}},{key:"hideDisableSetting",value:function(){this.setState({showDisableSetting:!1})}},{key:"showFaceID",value:function(){this.setState({showFaceID:!0,trackingText:"请您直视摄像头，正在识别中…."}),this.onChange();var e=this;setTimeout(function(){var t=document.getElementById("video"),a=document.getElementById("canvas"),n=a.getContext("2d"),l=null;if("WebSocket"in window){var r=window.location.host;l=new WebSocket("wss:"+r+"/api/change_find_face/")}else alert("对不起！你的浏览器不支持webSocket");l.onerror=function(){setTimeout(function(){o.stop(),t.pause(),t.srcObject.getVideoTracks()[0].stop()},100)},l.onopen=function(e){},l.onclose=function(){},window.onbeforeunload=function(){confirm("确定关闭窗口？")&&(l.close(),setTimeout(function(){o.stop(),t.pause(),t.srcObject.getVideoTracks()[0].stop()},100))},l.onmessage=function(r){r.data,200==r.data&&setTimeout(function(){n.clearRect(0,0,a.width,a.height),e.setState({trackingText:"采集完成，请输入用户名和密码！"}),o.stop(),l.close(),setTimeout(function(){o.stop(),t.pause(),t.srcObject.getVideoTracks()[0].stop()},100)},500),201==r.data&&(n.clearRect(0,0,a.width,a.height),e.setState({trackingText:"该人脸已被注册！"}),o.stop(),l.close(),setTimeout(function(){o.stop(),t.pause(),t.srcObject.getVideoTracks()[0].stop()},100)),202==r.data&&(n.clearRect(0,0,a.width,a.height),e.setState({trackingText:"人脸检测超时！"}),o.stop(),l.close(),setTimeout(function(){o.stop(),t.pause(),t.srcObject.getVideoTracks()[0].stop()},100))};var s=new tracking.ObjectTracker("face");s.setInitialScale(4),s.setStepSize(2),s.setEdgesDensity(.1);var o=tracking.track("#video",s,{camera:!0});o.run(),s.on("track",function(r){n.clearRect(0,0,a.width,a.height),r.data.forEach(function(r){n.drawImage(t,0,0,a.width,a.height),n.strokeStyle="#a64ceb",n.strokeRect(r.x,r.y,r.width,r.height);for(var s=n.getImageData(0,0,270,212),o=s.data,i=0;i<57240;i++){var u=o[4*i],c=o[4*i+1],d=o[4*i+2],f=.3*u+.59*c+.11*d;o[4*i]=f,o[4*i+1]=f,o[4*i+2]=f}n.putImageData(s,0,0,0,0,270,212);var m=a.toDataURL("image/jpeg",1);l.send(m+":#:"+e.state.UUID)})})},500)}},{key:"hideFaceID",value:function(){var e=document.getElementById("video");document.getElementById("canvas"),setTimeout(function(){e.pause(),e.srcObject.getVideoTracks()[0].stop()},100),this.setState({showFaceID:!1})}},{key:"showDisableFaceID",value:function(){this.setState({showDisableFaceID:!0}),this.onChange()}},{key:"hideDisableFaceID",value:function(){this.setState({showDisableFaceID:!1})}},{key:"getPhoneCode",value:function(e){e.preventDefault();var t=this,a=t.refs.phone.value,n=(0,f.default)(".getverificationCode");if(n.hasClass("disabled"))return!1;f.default.ajax({url:"/api/send_verify_code/",type:"POST",dataType:"json",cache:!1,data:{flag:0,phone:a,uuid_var:this.state.UUID},success:function(e){if(200==e.code){t.setState({phoneError:"验证码已发送至您的手机，请注意查收。"});var a=60,l=setInterval(function(){t.setState({phoneCodeText:a--}),n.addClass("disabled"),a<0&&(clearInterval(l),t.setState({phoneCodeText:"获取验证码"}),n.removeClass("disabled"))},1e3)}else t.setState({phoneError:e.message})},error:function(){t.setState({phoneError:"服务器异常，请检查您的网络状态！"})}})}},{key:"openPhoneVerify",value:function(e,t){e.preventDefault();var a=this,n=a.refs.phone?a.refs.phone.value:null,l=a.refs.phonecode?a.refs.phonecode.value:null,r=a.refs.password.value,s=a.refs.username.value;f.default.ajax({url:"/api/change_verify_config/",type:"POST",dataType:"json",cache:!1,data:{flag:t,phone:n,username:s,verify_code:l,password:(0,p.default)(r)},success:function(e){if(200==e.code){if(0==t&&1==a.state.flag)return a.setState({flag:0}),window.localStorage.setItem("flag",0),a.hideDisableSetting();if(0==t&&3==a.state.flag)return a.setState({flag:2}),window.localStorage.setItem("flag",2),a.hideDisableSetting();if(1==t&&2==a.state.flag)return a.setState({flag:0}),window.localStorage.setItem("flag",0),a.hideDisableFaceID();if(1==t&&3==a.state.flag)return a.setState({flag:1}),window.localStorage.setItem("flag",1),a.hideDisableFaceID();if(2==t&&0==a.state.flag)return a.setState({flag:1}),window.localStorage.setItem("flag",1),a.hideSetting();if(2==t&&2==a.state.flag)return a.setState({flag:3}),window.localStorage.setItem("flag",3),a.hideSetting()}},error:function(){}})}},{key:"openFaceIDVerify",value:function(e){e.preventDefault();var t=this,a=t.refs.facepassword.value,n=t.refs.faceusessname.value;f.default.ajax({url:"/api/change_verify_config/",type:"POST",dataType:"json",cache:!1,data:{flag:3,uuid:this.state.UUID,username:n,password:(0,p.default)(a)},success:function(e){if(200==e.code){if(0==t.state.flag)return t.setState({flag:2}),window.localStorage.setItem("flag",2),t.hideFaceID();if(1==t.state.flag)return t.setState({flag:3}),window.localStorage.setItem("flag",3),t.hideFaceID()}},error:function(){}})}},{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("flag");this.setState({flag:e})}},{key:"render",value:function(){var e=this;return c.default.createElement("div",{className:"additional settings-mode"},c.default.createElement("h2",{className:"content-title"},"登录附加凭证"),c.default.createElement("div",{className:"content"},1==this.state.flag||3==this.state.flag?c.default.createElement("div",{className:"verification-mobile verification-mobile-disable"},c.default.createElement("h5",null,"手机验证"),c.default.createElement("button",{className:"btn btn-xs btn-default ",onClick:this.showDisableSetting.bind(this)},"停用")):c.default.createElement("div",{className:"verification-mobile"},c.default.createElement("h5",null,"手机验证"),c.default.createElement("button",{className:"btn btn-xs btn-primary ",onClick:this.showSetting.bind(this)},"启用")),c.default.createElement("div",{className:"line"}),2==this.state.flag||3==this.state.flag?c.default.createElement("div",{className:"face-id face-id-disable"},c.default.createElement("h5",null,"面部识别"),c.default.createElement("button",{className:"btn btn-xs btn-default ",onClick:this.showDisableFaceID.bind(this)},"停用")):c.default.createElement("div",{className:"face-id"},c.default.createElement("h5",null,"面部识别"),c.default.createElement("button",{className:"btn btn-xs btn-primary ",onClick:this.showFaceID.bind(this)},"启用"))),this.state.showSetting&&c.default.createElement(m.Modal,o({backdrop:"static",id:"verification-mobile-modal",className:"settings-Modal"},this.props,{show:this.state.showSetting,onHide:function(){return e.hideSetting()},dialogClassName:"custom-modal"}),c.default.createElement("form",null,c.default.createElement(m.Modal.Header,{closeButton:!0},c.default.createElement(m.Modal.Title,null,"变更验证手机号")),c.default.createElement(m.Modal.Body,null,c.default.createElement("div",{style:{position:"relative"}},c.default.createElement("label",null,"手机号(用于短信验证)",c.default.createElement("input",{placeholder:"请输入您需要绑定的手机号",type:"text",name:"phone",ref:"phone",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurPhone(t)}}),c.default.createElement("div",{className:"getverificationCode",onClick:function(t){return e.getPhoneCode(t)}},this.state.phoneCodeText))),c.default.createElement("div",{className:"checkusers"},this.state.phoneError),c.default.createElement("label",null,"短信验证码",c.default.createElement("input",{type:"password",name:"password",ref:"phonecode",placeholder:"请输入短信验证码",className:"form-control"})),c.default.createElement("div",{className:"checkusers"},this.state.phonecodeError),c.default.createElement("label",null,"用户名",c.default.createElement("input",{placeholder:"请输入您的用户名",type:"text",name:"username",ref:"username",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurUsr(t)}})),c.default.createElement("div",{className:"checkusers"},this.state.usererror),c.default.createElement("label",null,"密码",c.default.createElement("input",{placeholder:"请输入您的密码",type:"password",name:"password",ref:"password",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurPWD(t)}})),c.default.createElement("div",{className:"checkusers "},this.state.pwderror)),c.default.createElement(m.Modal.Footer,null,c.default.createElement(m.Button,{className:"btn btn-xs  btn-default",onClick:function(){return e.hideSetting()}},"取消"),c.default.createElement(m.Button,{className:"btn btn-xs btn-primary",onClick:function(t){return e.openPhoneVerify(t,2)}},"变更手机号")))),c.default.createElement(m.Modal,o({backdrop:"static",className:"settings-Modal",id:"verification-mobile-disable-modal"},this.props,{show:this.state.showDisableSetting,onHide:function(){return e.hideDisableSetting()},dialogClassName:"custom-modal"}),c.default.createElement("form",null,c.default.createElement(m.Modal.Header,{closeButton:!0},c.default.createElement(m.Modal.Title,null,"停用手机验证")),c.default.createElement(m.Modal.Body,null,c.default.createElement("label",null,"用户名",c.default.createElement("input",{placeholder:"请输入您的用户名",type:"text",name:"username",ref:"username",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurUsr(t)}})),c.default.createElement("div",{className:"checkusers"},this.state.usererror),c.default.createElement("label",null,"密码",c.default.createElement("input",{placeholder:"请输入您的密码",type:"password",name:"password",ref:"password",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurPWD(t)}})),c.default.createElement("div",{className:"checkusers "},this.state.pwderror)),c.default.createElement(m.Modal.Footer,null,c.default.createElement(m.Button,{className:"btn btn-xs  btn-default",onClick:function(){return e.hideDisableSetting()}},"取消"),c.default.createElement(m.Button,{className:"btn btn-xs btn-primary",onClick:function(t){return e.openPhoneVerify(t,0)}},"停用手机验证")))),this.state.showFaceID&&c.default.createElement(m.Modal,o({backdrop:"static",className:"settings-Modal",id:"verification-FaceID-modal"},this.props,{show:this.state.showFaceID,onHide:function(){return e.hideFaceID()},dialogClassName:"custom-modal"}),c.default.createElement(m.Modal.Header,{closeButton:!0},c.default.createElement(m.Modal.Title,null,"更新面部识别信息")),c.default.createElement(m.Modal.Body,null,c.default.createElement("div",{className:"face-container"},c.default.createElement("video",{id:"video",width:"270",height:"212",preload:!0,autoPlay:!0,loop:!0,muted:!0}),c.default.createElement("canvas",{id:"canvas",width:"270",height:"212"}),c.default.createElement("div",{className:"faceIDRight"},c.default.createElement("p",{style:{fontSize:"12px",color:"#a1a6ad"}},"人脸信息采集"),c.default.createElement("div",{style:{fontSize:"12px",color:"#fff"}},this.state.trackingText))),c.default.createElement("label",null,"用户名",c.default.createElement("input",{placeholder:"请输入您的用户名",type:"text",name:"username",ref:"faceusessname",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurUsr(t)}})),c.default.createElement("div",{className:"checkusers"},this.state.usererror),c.default.createElement("label",null,"密码",c.default.createElement("input",{placeholder:"请输入您的密码",type:"password",name:"password",ref:"facepassword",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurPWD(t)}})),c.default.createElement("div",{className:"checkusers"},this.state.pwderror)),c.default.createElement(m.Modal.Footer,null,c.default.createElement(m.Button,{className:"btn btn-xs  btn-default",onClick:function(){return e.hideFaceID()}},"取消"),c.default.createElement(m.Button,{className:"btn btn-xs btn-primary",onClick:function(t){return e.openFaceIDVerify(t)}},"采用新面部信息"))),c.default.createElement(m.Modal,o({backdrop:"static",className:"settings-Modal",id:"verification-FaceID-disable-modal"},this.props,{show:this.state.showDisableFaceID,onHide:function(){return e.hideDisableFaceID()},dialogClassName:"custom-modal"}),c.default.createElement("form",null,c.default.createElement(m.Modal.Header,{closeButton:!0},c.default.createElement(m.Modal.Title,null,"停用面部识别")),c.default.createElement(m.Modal.Body,null,c.default.createElement("label",null,"用户名",c.default.createElement("input",{placeholder:"请输入您的用户名",type:"text",name:"username",ref:"username",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurUsr(t)}})),c.default.createElement("div",{className:"checkusers"},this.state.usererror),c.default.createElement("label",null,"密码",c.default.createElement("input",{placeholder:"请输入您的密码",type:"password",name:"password",ref:"password",className:"form-control",onChange:function(){return e.onChange()},onBlur:function(t){return e.onBlurPWD(t)}})),c.default.createElement("div",{className:"checkusers "},this.state.pwderror)),c.default.createElement(m.Modal.Footer,null,c.default.createElement(m.Button,{className:"btn btn-xs  btn-default",onClick:function(){return e.hideDisableFaceID()}},"取消"),c.default.createElement(m.Button,{className:"btn btn-xs btn-primary",onClick:function(t){return e.openPhoneVerify(t,1)}},"停用面部识别")))))}}]),t}(c.default.Component);t.default=y},1397:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),u=n(i),c=a(23),d=n(c),f=(a(100),function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={userSelectSet:!1,userSelectValue:"",userSelectIndex:!1,userSelectErrorMsg:""},a}return s(t,e),o(t,[{key:"handleUserSelectSet",value:function(e){/^P$/i.test(e.target.tagName)&&this.setState({userSelectValue:(0,d.default)(e.target).text(),userSelectIndex:(0,d.default)(e.target).index().toString()}),this.setState({userSelectSet:!this.state.userSelectSet})}},{key:"putInTimeSet",value:function(e){var t=/^[0-9]+$/,a=parseInt((0,d.default)(e.target).val());t.test((0,d.default)(e.target).val())||(0,d.default)(e.target).val(""),a<=0&&(0,d.default)(e.target).val(""),a>=14400&&(0,d.default)(e.target).val(14400)}},{key:"userSetCookieTime",value:function(e){var t=(0,d.default)("#userSetMinute").val(),a=new Date;a.setTime(a.getTime()+60*t*1e3),document.cookie="userSystemSetType="+(e||this.state.userSelectIndex)+";expires="+a.toGMTString()}},{key:"systemSetConfirmAjax",value:function(){if(""==(0,d.default)("#userSetMinute").val())this.setState({userSelectErrorMsg:"请填写账户在线时长"});else if(""==this.state.userSelectValue)this.setState({userSelectErrorMsg:"请选择登录打开页面的方式"});else{this.userSetCookieTime(!1);var e=this;d.default.ajax({url:"/api/settings/set_session_timeout/",type:"POST",dataType:"json",data:{timeout:(0,d.default)("#userSetMinute").val()},cache:!1,success:function(t){200==t.code||203==t.code?(e.setState({userSelectErrorMsg:"设置成功"}),setTimeout(function(){e.setState({userSelectErrorMsg:""})},200)):e.setState({userSelectErrorMsg:t.message})},error:function(){e.setState({userSelectErrorMsg:"服务繁忙，请稍后重试～"})}})}}},{key:"getCookie",value:function(e){for(var t=document.cookie,a=t.split("; "),n=0;n<a.length;n++){var l=a[n].split("=");if(l[0]==e)return l[1]}return""}},{key:"deleteCookie",value:function(e){var t=new Date;t.setTime(t.getTime()-1e4),document.cookie=e+"=v; expires="+t.toGMTString()}},{key:"componentWillMount",value:function(){var e=this;d.default.ajax({url:"/api/settings/get_session_timeout/",type:"POST",dataType:"json",cache:!1,success:function(t){if(200==t.code||203==t.code){if((0,d.default)("#userSetMinute").val(t.timeout),""==e.getCookie("userSystemSetType"))return;var a=e.getCookie("userSystemSetType");e.userSetCookieTime(a),e.setState({userSelectValue:0==a?"仅打开首页":"自动开启首页、信息中心、攻防态势、全球态势感知、3D地球共 5 个页面",userSelectIndex:a})}else e.deleteCookie("userSystemSetType"),(0,d.default)("#userSetMinute").val("")},error:function(){e.deleteCookie("userSystemSetType"),(0,d.default)("#userSetMinute").val("")}})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"generalS-sttings settings-mode"},u.default.createElement("h2",{className:"content-title"},"通用设置"),u.default.createElement("div",{className:"globalSystemSetNormal"},u.default.createElement("h2",null,"连续在线时长"),u.default.createElement("div",{className:"writeTime"},u.default.createElement("h3",null,u.default.createElement("input",{type:"text",id:"userSetMinute",onKeyUp:this.putInTimeSet.bind(this),onKeyDown:this.putInTimeSet.bind(this)})," 分钟 ( 最高不超过240小时 ) "),u.default.createElement("p",null,"为确保安全，您可以设置系统保持登录的时长。超过时限后，系统自动登出。")),u.default.createElement("h2",null,"登陆后打开的窗口"),u.default.createElement("div",{className:"selectSystemSet",onClick:this.handleUserSelectSet.bind(this)},u.default.createElement("input",{className:"userSelectSet",type:"text",readOnly:!0,value:""==this.state.userSelectValue?"仅打开首页":this.state.userSelectValue}),this.state.userSelectSet&&u.default.createElement("div",{className:"selectSetList"},u.default.createElement("p",null,"仅打开首页"),u.default.createElement("p",null,"自动开启首页、信息中心、攻防态势、全球态势感知、3D地球共 5 个页面"))),u.default.createElement("p",{className:"errorMsg"},this.state.userSelectErrorMsg),u.default.createElement("div",{className:"userSetConfimBtn"},u.default.createElement("button",{className:"userSetConfirm  btn btn-sm btn-primary",onClick:function(){return e.systemSetConfirmAjax()}},"确认"))))}}]),t}(u.default.Component));t.default=f},1398:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),u=n(i),c=a(23),d=n(c),f=a(100),m=function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={enabledSys:null,disableSys:null},a}return s(t,e),o(t,[{key:"showGlobalSystem",value:function(){var e=this;d.default.ajax({type:"POST",dataType:"json",url:"/api/settings/get_warninglist/",error:function(){},success:function(t){var a=[],n=[];t.filter(function(e,t){return 1==e.enabled?(a.push(e),a):0==e.enabled?(n.push(e),n):void 0}),e.setState({enabledSys:a,disableSys:n})}})}},{key:"RUDwarninglist",value:function(e){var t=this,a="",n=[];n=2==e?(0,d.default)(".disable-communication tbody  tr td a.onSelect"):(0,d.default)(".enabled-communication tbody  tr td a.onSelect");for(var l=0;l<n.length;l++)a+=(0,d.default)(n[l]).attr("title")+"#";d.default.ajax({url:"/api/settings/update_warninglist/",dataType:"json",type:"POST",data:{type:e,data:a},beforeSend:function(){if(!a.length)return!1},success:function(){(0,d.default)(".communicationStyle  a").removeClass("onSelect"),t.showGlobalSystem()},error:function(){t.showGlobalSystem()}})}},{key:"addWarningList",value:function(){var e=this,t=document.querySelector(".enabled-content tbody"),a=document.createElement("tr");t.appendChild(a);var n=document.createElement("td");n.innerHTML="<input type='text'　name='enabledAdd' autoFocus placeholder=请输入新增电话  style='width:120px; height: 24px; border-radius: 4px;background: transparent; border: 1px solid #ccc; padding: 6px 10px;'>",a.appendChild(n);var n=document.createElement("td");n.innerHTML="<input type='text'　name='enabledAdd' placeholder=请输入新增邮箱  style='width:120px; height: 24px; border-radius: 4px;background: transparent; border: 1px solid #ccc; padding: 6px 10px;'>",a.appendChild(n),n=document.createElement("td"),n.innerHTML="<span style='color:#32a1ff'>确定</span>&nbsp;<span style='color:#CB4B4B'>取消</span>",a.appendChild(n),n.children[1].onclick=function(){t.removeChild(this.parentNode.parentNode)},n.children[0].onclick=function(){var n=a.children[0].children[0].value,l=a.children[1].children[0].value,r=this;return/^([0-9A-Za-z\-_\.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g.test(l)?/((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/.test(n)?void d.default.ajax({url:"/api/settings/add_warninglist/",type:"POST",dataType:"json",data:{phone:n,email:l},error:function(){e.showGlobalSystem(),t.removeChild(r.parentNode.parentNode)},success:function(){e.showGlobalSystem(),t.removeChild(r.parentNode.parentNode)}}):void d.default.toast({text:"请检查您输入的手机号",showHideTransition:"fade",allowToastClose:!0,hideAfter:5e3,loader:!1,stack:!1,position:"top-center",textAlign:"center"}):void d.default.toast({text:"请检查您输入的邮箱",showHideTransition:"fade",allowToastClose:!0,hideAfter:5e3,loader:!1,stack:!1,position:"top-center",textAlign:"center"})}}},{key:"enabledSelecAll",value:function(e,t){if((0,d.default)(e.target).is(".onSelect")){(0,d.default)(e.target).removeClass("onSelect");for(var a=(0,d.default)("."+t+"  .enabled-content tbody tr td a"),n=0;n<a.length;n++)(0,d.default)(a[n]).removeClass("onSelect")}else{(0,d.default)(e.target).addClass("onSelect");for(var a=(0,d.default)("."+t+"  .enabled-content tbody tr td a"),n=0;n<a.length;n++)(0,d.default)(a[n]).addClass("onSelect")}}},{key:"enabledSingle",value:function(e,t){(0,d.default)(e.target).toggleClass("onSelect"),this.allchk(t)}},{key:"componentDidMount",value:function(){this.showGlobalSystem()}},{key:"allchk",value:function(e){var t=(0,d.default)("."+e+" tbody  tr td a").size(),a=0;(0,d.default)("."+e+" tbody  tr td a").each(function(){1==(0,d.default)(this).hasClass("onSelect")&&a++}),t==a?(0,d.default)("."+e+"   th  a").addClass("onSelect"):(0,d.default)("."+e+"   th  a").removeClass("onSelect")}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"warning-mode settings-mode"},u.default.createElement("h2",{className:"content-title"},"警告通讯方式"),u.default.createElement("div",{className:"communicationStyle"},u.default.createElement(f.Grid,null,u.default.createElement("h4",null,"警告通讯方式"),u.default.createElement(f.Row,{className:"show-grid"},u.default.createElement(f.Col,{xs:12,md:6}," ",u.default.createElement("div",{className:"enabled-communication "},u.default.createElement("div",{className:"clearfix"},u.default.createElement("h6",null,"已启用的警告通讯方式"),u.default.createElement("div",{className:"enabled-del",onClick:function(){return e.RUDwarninglist(0)}},"删除"),u.default.createElement("div",{className:"enabled-dis",onClick:function(){return e.RUDwarninglist(1)}},"停用"),u.default.createElement("div",{className:"enabled-add",onClick:function(){return e.addWarningList()}},"新增")),u.default.createElement("div",{className:"enabled-content"},u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",null,u.default.createElement("a",{onClick:function(t){return e.enabledSelecAll(t,"enabled-communication")}})),u.default.createElement("th",null,"电话"),u.default.createElement("th",null,"邮箱"))),u.default.createElement("tbody",null,this.state.enabledSys&&this.state.enabledSys.map(function(e,t){var a=this;return u.default.createElement("tr",{key:t},u.default.createElement("td",null,u.default.createElement("a",{onClick:function(e){return a.enabledSingle(e,"enabled-communication")},title:e.id}," ")),u.default.createElement("td",null," ",e.phone),u.default.createElement("td",null,e.email))}.bind(this))))))),u.default.createElement(f.Col,{xs:12,md:6},u.default.createElement("div",{className:"disable-communication"},u.default.createElement("div",{className:"clearfix"},u.default.createElement("h6",null,"停用的警告通讯方式"),u.default.createElement("div",{className:"enabled-dis",onClick:function(){return e.RUDwarninglist(2)}},"启用")),u.default.createElement("div",{className:"enabled-content"},u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",null,u.default.createElement("a",{onClick:function(t){return e.enabledSelecAll(t,"disable-communication")}})," "),u.default.createElement("th",null,"电话"),u.default.createElement("th",null,"邮箱"))),u.default.createElement("tbody",null,this.state.disableSys&&this.state.disableSys.map(function(e,t){var a=this;return u.default.createElement("tr",{key:"disableSys"+t},u.default.createElement("td",null,u.default.createElement("a",{onClick:function(e){return a.enabledSingle(e,"disable-communication")},title:e.id})),u.default.createElement("td",null,e.phone),u.default.createElement("td",null,e.email))}.bind(this)))))))))))}}]),t}(u.default.Component);t.default=m},1399:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),u=n(i),c=a(23),d=n(c),f=a(100),m=a(131),h=a(1353),p=n(h),g=function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={alarmDetailShow:!1,alarmTitle:"异常行为历史警告"},a.sourceTypes=[{name:"异常行为警告",value:"2"},{name:"系统警告",value:"3"},{name:"用户画像警告",value:"4"},{name:"显示所有",value:"-1"}],a.pageCount=0,a.pageSize=8,a.currentPage=1,a.alarm_type=2,a.searchItem=null,a}return s(t,e),o(t,[{key:"handleSelectPage",value:function(e){this.currentPage=e,this.getHostList(),this.initialAllCheckbox()}},{key:"handleJumpPage",value:function(){this.currentPage=parseInt((0,d.default)("#hostlistPage").val()),this.getHostList(),this.initialAllCheckbox()}},{key:"jumpPageKeyDown",value:function(e){13===e.keyCode&&this.handleJumpPage()}},{key:"onChangeInputPage",value:function(e){var t=e.target.value;""!=t&&(!(0,m.isInt)(t)||0==t||t>this.pageCount)&&(0,d.default)("#hostlistPage").val("")}},{key:"getHostList",value:function(){var e=this;d.default.ajax({url:"/api/alarm/get_alarm_records_by_count/",type:"GET",dataType:"json",data:{page:e.currentPage,size:e.pageSize,keyword:e.searchItem,alarm_type:e.alarm_type},cache:!1,traditional:!0,success:function(t){t&&(e.pageCount=Math.ceil(t.totalpage/e.pageSize),e.setState({hostlist:t.curr_page}))},error:function(){}})}},{key:"initialAllCheckbox",value:function(){(0,d.default)(".hostlist-hostname input").prop("checked",!1)}},{key:"componentWillMount",value:function(){this.getHostList(),this.initialAllCheckbox()}},{key:"onChangeSearchInput",value:function(){this.searchItem=(0,d.default)("#searchAlarmInput").val()}},{key:"searchKeyDown",value:function(e){13===e.keyCode&&this.handleSearchHost()}},{key:"handleSearchHost",value:function(){this.currentPage=1,this.getHostList(),this.initialAllCheckbox()}},{key:"onChangeRange",value:function(e){this.alarm_type=e,this.currentPage=1,this.getHostList(),this.initialAllCheckbox()}},{key:"alarmList",value:function(e){var t=this;this.setState({alarmDetailShow:!0,alarmTitle:"异常行为历史警告 / "+e}),d.default.ajax({url:"/api/alarm/get_alarm_details/",type:"GET",dataType:"json",data:{id:e},success:function(e){t.setState({alarmList_ip:e[0].ip,alarmList_id:e[0].id,alarmList_hostname:e[0].hostname,alarmList_time:e[0].time,alarmList_type:e[0].type_info,alarmList_info:e[0].alarm_info})}})}},{key:"alarmDetailHide",value:function(){this.setState({alarmDetailShow:!1,alarmTitle:"用户列表"})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"warning-mode settings-mode"},u.default.createElement("h2",{className:"content-title",onClick:function(){return e.alarmDetailHide()}},this.state.alarmTitle),!this.state.alarmDetailShow&&u.default.createElement("div",null,u.default.createElement("div",{className:"container"},u.default.createElement("div",{className:"clearfix",style:{margin:"20px 0"}},u.default.createElement(p.default,{listID:"alarm-list-dropdown",itemsToSelect:this.sourceTypes,onSelect:function(t){return e.onChangeRange(t)},itemDefault:function(e,t){for(var a=0;a<t.length;a++)if(t[a].value==e)return t[a]}(this.state.source,this.sourceTypes)}),u.default.createElement("div",{style:{float:"right"}},u.default.createElement("input",{style:{width:"270px",float:"left"},id:"searchAlarmInput",type:"text",placeholder:"搜索别名或IP",className:"form-control input-search",onChange:this.onChangeSearchInput.bind(this),onKeyDown:this.searchKeyDown.bind(this)}),u.default.createElement("button",{style:{float:"right",marginLeft:"20px"},className:"btn-search btn btn-sm btn-primary",onClick:this.handleSearchHost.bind(this)},"搜索")))),u.default.createElement("table",{className:"hostlist-table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{className:"hostlist-hostname"},"ID",u.default.createElement("i",{className:0==this.sortByHostname?"fa fa-angle-up":"fa fa-angle-down","aria-hidden":"true"})),u.default.createElement("th",{className:"hostlist-hostip"},"报警类型",u.default.createElement("i",{className:0==this.sortByIP?"fa fa-angle-up":"fa fa-angle-down","aria-hidden":"true"})),u.default.createElement("th",{className:"hostlist-description"},"IP"),u.default.createElement("th",{className:"hostlist-status"},"hostname",u.default.createElement("i",{className:0==this.sortByStatus?"fa fa-angle-up":"fa fa-angle-down","aria-hidden":"true"})),u.default.createElement("th",{className:"hostlist-status"},"时间",u.default.createElement("i",{className:0==this.sortByStatus?"fa fa-angle-up":"fa fa-angle-down","aria-hidden":"true"})))),u.default.createElement("tbody",null,this.state.hostlist&&this.state.hostlist.map(function(e,t){var a=this;return u.default.createElement("tr",{className:"hostlist-detail",key:t,onClick:function(){return a.alarmList(e.id)}},u.default.createElement("td",{className:"hostlist-hostname"},e.id),u.default.createElement("td",{className:"hostlist-hostip"},e.type_info),u.default.createElement("td",{className:"hostlist-description"},e.ip),u.default.createElement("td",{className:"hostlist-status"},e.hostname),u.default.createElement("td",{className:"hostlist-status"},e.time))}.bind(this)),(!this.state.hostlist||!this.state.hostlist.length)&&u.default.createElement("tr",{className:"hostlist-detail"},u.default.createElement("td",null,"当前没有匹配的数据。")))),u.default.createElement("div",{className:"pagination-all"},u.default.createElement(f.Pagination,{prev:!0,next:!0,first:!1,last:!1,ellipsis:!0,boundaryLinks:!0,items:this.pageCount,maxButtons:7,activePage:this.currentPage,onSelect:this.handleSelectPage.bind(this)}),u.default.createElement("div",{className:"pageCount"},u.default.createElement("input",{className:"pageNum",id:"hostlistPage",placeholder:"输入",onChange:this.onChangeInputPage.bind(this),onKeyDown:this.jumpPageKeyDown.bind(this)}),u.default.createElement("img",{className:"searchNum",onClick:this.handleJumpPage.bind(this),src:"/static/img/skip.svg"})))),this.state.alarmDetailShow&&u.default.createElement("div",{className:"container",style:{marginTop:"20px"}},u.default.createElement("table",{className:"alarm-detail-table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",null,"ID"),u.default.createElement("th",null,"报警类型"),u.default.createElement("th",null,"IP"),u.default.createElement("th",null,"hostname"),u.default.createElement("th",null,"时间"))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",null,this.state.alarmList_id),u.default.createElement("td",null,this.state.alarmList_type),u.default.createElement("td",null,this.state.alarmList_ip),u.default.createElement("td",null,this.state.alarmList_hostname),u.default.createElement("td",null,this.state.alarmList_time)))),u.default.createElement("div",{className:"alarm-log"},u.default.createElement("div",{className:"alarm-log-title"},"详细日志"),u.default.createElement("pre",null,'"'+this.state.alarmList_info+'"'," "))))}}]),t}(u.default.Component);t.default=g}});